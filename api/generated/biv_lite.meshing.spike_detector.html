

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>biv_lite.meshing.spike_detector &mdash; biv-lite 0.2.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=6ffd866b"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="biv_lite.meshing.utils" href="biv_lite.meshing.utils.html" />
    <link rel="prev" title="biv_lite.meshing.mesh" href="biv_lite.meshing.mesh.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            biv-lite
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Modules Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="biv_lite.html">biv_lite</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="biv_lite.app.html">biv_lite.app</a></li>
<li class="toctree-l3"><a class="reference internal" href="biv_lite.biv_frames.html">biv_lite.biv_frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="biv_lite.biv_mesh.html">biv_lite.biv_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="biv_lite.biv_parametric.html">biv_lite.biv_parametric</a></li>
<li class="toctree-l3"><a class="reference internal" href="biv_lite.main.html">biv_lite.main</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="biv_lite.meshing.html">biv_lite.meshing</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.biv_motion_ui.html">biv_lite.meshing.biv_motion_ui</a></li>
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.geometric_tools.html">biv_lite.meshing.geometric_tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.imputation.html">biv_lite.meshing.imputation</a></li>
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.mesh.html">biv_lite.meshing.mesh</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">biv_lite.meshing.spike_detector</a></li>
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.utils.html">biv_lite.meshing.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="biv_lite.meshing.vis.html">biv_lite.meshing.vis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../biv_mesh.html">BivMesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biv_frames.html">BivFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biv_parametric.html">BivParametric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../biv_motion_ui.html">BivMotionUI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/avansp/biv-lite">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/avansp/biv-lite/issues">Issue Tracker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">biv-lite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../modules.html">Modules Overview</a></li>
          <li class="breadcrumb-item"><a href="biv_lite.html">biv_lite</a></li>
          <li class="breadcrumb-item"><a href="biv_lite.meshing.html">biv_lite.meshing</a></li>
      <li class="breadcrumb-item active">biv_lite.meshing.spike_detector</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/generated/biv_lite.meshing.spike_detector.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-biv_lite.meshing.spike_detector">
<span id="biv-lite-meshing-spike-detector"></span><h1>biv_lite.meshing.spike_detector<a class="headerlink" href="#module-biv_lite.meshing.spike_detector" title="Link to this heading"></a></h1>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#biv_lite.meshing.spike_detector.mad_lm" title="biv_lite.meshing.spike_detector.mad_lm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mad_lm</span></code></a>(y[, w])</p></td>
<td><p>Detect spikes from relative madness of the base linear model deviation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#biv_lite.meshing.spike_detector.relative_madness" title="biv_lite.meshing.spike_detector.relative_madness"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relative_madness</span></code></a>(y[, w])</p></td>
<td><p>Compute relative MADness (MAD = median absolute deviation).</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="biv_lite.meshing.spike_detector.relative_madness">
<span class="sig-prename descclassname"><span class="pre">biv_lite.meshing.spike_detector.</span></span><span class="sig-name descname"><span class="pre">relative_madness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/biv_lite/meshing/spike_detector.html#relative_madness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biv_lite.meshing.spike_detector.relative_madness" title="Link to this definition"></a></dt>
<dd><p>Compute relative MADness (MAD = median absolute deviation).</p>
<p>The relative madness is defined as the absolute difference between a point and the median of its
immediate neighbours, minus the median absolute deviation of the three points.
This can be used to identify spikes in a signal.</p>
<p>Source: <a class="reference external" href="https://gist.github.com/w121211/fbd35d1a8776402ac9fe24654ca8044f">https://gist.github.com/w121211/fbd35d1a8776402ac9fe24654ca8044f</a></p>
<dl>
<dt>The definition of relative MADness for window w=3 for point at y(i) is given as follows:</dt><dd><p>median_i = median([y(i-1), y(i), y(i+1)])
mad(i) = | y(i) - median_i |</p>
<p>rel_mad(i) = mad(i) - median([ | y(j) - median_i <a href="#id1"><span class="problematic" id="id2">|</span></a>, for {j in [i-1, i, i+1]} ])</p>
</dd>
</dl>
<p>The implementation below has been optimized for all points of y</p>
<p>Note that spike can be detected as relative madness &gt; 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>np.array</em>) – 1D array of values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D array of relative madness values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="biv_lite.meshing.spike_detector.mad_lm">
<span class="sig-prename descclassname"><span class="pre">biv_lite.meshing.spike_detector.</span></span><span class="sig-name descname"><span class="pre">mad_lm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/biv_lite/meshing/spike_detector.html#mad_lm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#biv_lite.meshing.spike_detector.mad_lm" title="Link to this definition"></a></dt>
<dd><p>Detect spikes from relative madness of the base linear model deviation.</p>
<p>This is an improved version of relative madness, where the input to that spike detection is the y,
but the relative deviation of each point to the linear model defined by its base points.</p>
<p>Let [y1, y2, y3] are three points on y and we want to check whether y2 is a spike or not.</p>
<dl class="simple">
<dt>First, define a linear model based on y1 and y3 as follows:</dt><dd><p>L13 = 0.5 * (y3 - y1) + y1</p>
</dd>
<dt>Then calculate the absolute deviation of y2 from L13:</dt><dd><p>d2 = abs(y2 - L13)</p>
</dd>
</dl>
<p>Using all values of y, the input for relative_madness becomes absolute deviations for all points.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="biv_lite.meshing.mesh.html" class="btn btn-neutral float-left" title="biv_lite.meshing.mesh" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="biv_lite.meshing.utils.html" class="btn btn-neutral float-right" title="biv_lite.meshing.utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>